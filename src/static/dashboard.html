<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workspace Project Dashboard</title>
    <link rel="stylesheet" href="/dashboard/style.css">
    <!-- Monaco Editor CDN -->
    <script src="https://unpkg.com/monaco-editor@0.44.0/min/vs/loader.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Workspace Project Dashboard</h1>
            <div class="status-indicators">
                <div class="status-item">
                    <span class="status-label">Server</span>
                    <span class="status-value online">Online</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Last Updated</span>
                    <span class="status-value" id="last-updated">--</span>
                </div>
            </div>
        </header>

        <main>
            <div class="dashboard-grid">
                <!-- Project Overview -->
                <section class="card overview">
                    <h2>Project Overview</h2>
                    <div class="project-info">
                        <div class="project-name" id="project-name">Loading...</div>
                        <div class="project-description" id="project-description">--</div>
                    </div>
                </section>

                <!-- Feature Metrics -->
                <section class="card metrics">
                    <h2>Feature Progress</h2>
                    <div class="metrics-grid">
                        <div class="metric">
                            <div class="metric-value" id="total-features">--</div>
                            <div class="metric-label">Total Features</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="implemented-features">--</div>
                            <div class="metric-label">Implemented</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="tested-features">--</div>
                            <div class="metric-label">Tested</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="implementation-percentage">--%</div>
                            <div class="metric-label">Implementation</div>
                        </div>
                    </div>
                    <div class="progress-bars">
                        <div class="progress-bar">
                            <label>Implementation Progress</label>
                            <div class="bar">
                                <div class="fill implementation" id="implementation-bar"></div>
                            </div>
                        </div>
                        <div class="progress-bar">
                            <label>Test Coverage</label>
                            <div class="bar">
                                <div class="fill testing" id="testing-bar"></div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Task Summary -->
                <section class="card tasks">
                    <h2>Task Summary</h2>
                    <div class="task-stats">
                        <div class="task-stat pending">
                            <div class="count" id="pending-tasks">--</div>
                            <div class="label">Pending</div>
                        </div>
                        <div class="task-stat progress">
                            <div class="count" id="progress-tasks">--</div>
                            <div class="label">In Progress</div>
                        </div>
                        <div class="task-stat completed">
                            <div class="count" id="completed-tasks">--</div>
                            <div class="label">Completed</div>
                        </div>
                        <div class="task-stat blocked">
                            <div class="count" id="blocked-tasks">--</div>
                            <div class="label">Blocked</div>
                        </div>
                    </div>
                </section>

                <!-- Feature List -->
                <section class="card feature-list">
                    <h2>Recent Features</h2>
                    <div class="feature-controls">
                        <button class="filter-btn active" data-filter="all">All</button>
                        <button class="filter-btn" data-filter="pending">Pending</button>
                        <button class="filter-btn" data-filter="implemented">Implemented</button>
                        <button class="filter-btn" data-filter="tested">Tested</button>
                    </div>
                    <div class="feature-items" id="feature-list">
                        <div class="loading">Loading features...</div>
                    </div>
                </section>

                <!-- Task List -->
                <section class="card task-list">
                    <h2>Active Tasks</h2>
                    <div class="task-controls">
                        <button class="filter-btn active" data-filter="all">All</button>
                        <button class="filter-btn" data-filter="pending">Pending</button>
                        <button class="filter-btn" data-filter="in_progress">In Progress</button>
                        <button class="filter-btn" data-filter="blocked">Blocked</button>
                    </div>
                    <div class="task-items" id="task-list">
                        <div class="loading">Loading tasks...</div>
                    </div>
                </section>

                <!-- Directive List -->
                <section class="card directive-list">
                    <h2>Project Directives</h2>
                    <div class="directive-controls">
                        <button class="filter-btn active" data-filter="all">All</button>
                        <button class="filter-btn" data-filter="development">Development</button>
                        <button class="filter-btn" data-filter="security">Security</button>
                        <button class="filter-btn" data-filter="testing">Testing</button>
                    </div>
                    <div class="directive-items" id="directive-list">
                        <div class="loading">Loading directives...</div>
                    </div>
                </section>

                <!-- Entity Relationships -->
                <section class="card relationship-list">
                    <h2>Entity Relationships</h2>
                    <div class="relationship-controls">
                        <button class="filter-btn active" data-filter="all">All</button>
                        <button class="filter-btn" data-filter="implements">Implements</button>
                        <button class="filter-btn" data-filter="depends_on">Depends On</button>
                        <button class="filter-btn" data-filter="blocks">Blocks</button>
                        <button class="filter-btn" data-filter="worked_in">Worked In</button>
                    </div>
                    <div class="relationship-items" id="relationship-list">
                        <div class="loading">Loading relationships...</div>
                    </div>
                </section>

                <!-- Milestones -->
                <section class="card milestones">
                    <h2>Project Milestones</h2>
                    <div class="milestone-filters">
                        <button class="filter-btn active" data-filter="all">All Milestones</button>
                        <button class="filter-btn" data-filter="planned">Planned</button>
                        <button class="filter-btn" data-filter="in_progress">In Progress</button>
                        <button class="filter-btn" data-filter="achieved">Achieved</button>
                    </div>
                    <div class="milestone-items" id="milestone-list">
                        <div class="loading">Loading milestones...</div>
                    </div>
                </section>

                <!-- Note Links -->
                <section class="card note-links">
                    <h2>Note Links</h2>
                    <div class="note-link-controls">
                        <button class="filter-btn active" data-filter="all">All Links</button>
                        <button class="filter-btn" data-filter="reference">References</button>
                        <button class="filter-btn" data-filter="related">Related</button>
                        <button class="filter-btn" data-filter="blocks">Blocks</button>
                        <button class="filter-btn" data-filter="auto">Auto-Detected</button>
                    </div>
                    <div class="note-link-items" id="note-link-list">
                        <div class="loading">Loading note links...</div>
                    </div>
                </section>

                <!-- Recent Activity -->
                <section class="card activity">
                    <h2>Recent Activity</h2>
                    <div class="activity-list" id="activity-list">
                        <div class="loading">Loading activity...</div>
                    </div>
                </section>

                <!-- Git Timeline and File Browser -->
                <section class="card timeline full-width" style="grid-column: 1 / -1;">
                    <h2>Project Timeline & File Browser</h2>
                    <div class="timeline-controls">
                        <button id="timeline-btn" class="tab-btn active">Timeline</button>
                        <button id="files-btn" class="tab-btn">Files</button>
                        <button id="commits-btn" class="tab-btn">Commits</button>
                    </div>
                    
                    <div id="timeline-view" class="timeline-content">
                        <div class="timeline-list" id="timeline-list">
                            <div class="loading">Loading timeline...</div>
                        </div>
                    </div>
                    
                    <div id="files-view" class="files-content" style="display: none;">
                        <div class="files-browser">
                            <div class="files-sidebar">
                                <div class="commit-selector">
                                    <label for="commit-select">Browse at commit:</label>
                                    <select id="commit-select">
                                        <option value="HEAD">Latest (HEAD)</option>
                                    </select>
                                </div>
                                <div class="file-tree" id="file-tree">
                                    <div class="loading">Loading files...</div>
                                </div>
                            </div>
                            <div class="file-viewer">
                                <div class="file-header">
                                    <span id="current-file-path">Select a file to view</span>
                                    <div class="file-actions">
                                        <button id="show-diff-btn" disabled>Show Diff</button>
                                    </div>
                                </div>
                                <div id="monaco-container" style="height: 600px; border: 1px solid #ccc;"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="commits-view" class="commits-content" style="display: none;">
                        <div class="commits-list" id="commits-list">
                            <div class="loading">Loading commits...</div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Diff Modal -->
    <div id="diff-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>File Diff</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div id="diff-container" style="height: 500px;"></div>
            </div>
        </div>
    </div>

    <script src="/dashboard/app.js"></script>
</body>
</html>